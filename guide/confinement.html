<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="site">
<meta name="generator" content="Paradox, paradox-material-theme=0.4.0, mkdocs-material=2.2.2">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.language" content="">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="site">
<link rel="shortcut icon" href="../assets/images/favicon.png">
<title>Confining Capabilities Â· Introduction</title>
<link rel="stylesheet" href="../assets/stylesheets/application.7a4cdee3.css">
<link rel="stylesheet" href="../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../lib/prettify/prettify.css">
<script src="../lib/modernizr/modernizr.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
<label class="md-overlay" data-md-component="overlay" for="drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../index.html" title="Introduction" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Introduction
</span>
<span class="md-header-nav__topic">
Confining Capabilities
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="search"></label>
<div class="md-search__inner">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
<label class="md-icon md-search__icon" for="search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</span>
<a href="../index.html" title="Introduction">
Introduction
</a>
</label>
<ul>
  <li><a href="../running.html" class="page">Running</a></li>
  <li><a href="../examples/index.html" class="page">Examples</a>
  <ul>
    <li><a href="../examples/overview.html" class="page">Overview</a></li>
    <li><a href="../examples/composition.html" class="page">Composition</a></li>
    <li><a href="../examples/attenuation.html" class="page">Attenuation</a></li>
    <li><a href="../examples/modulation.html" class="page">Modulation</a></li>
    <li><a href="../examples/revocation.html" class="page">Revocation</a></li>
    <li><a href="../examples/amplification.html" class="page">Amplification</a></li>
    <li><a href="../examples/delegation.html" class="page">Delegation</a></li>
    <li><a href="../examples/gatekeeper.html" class="page">Gatekeeper</a></li>
    <li><a href="../examples/dynamic_seal.html" class="page">Dynamic Sealing</a></li>
    <li><a href="../examples/membrane.html" class="page">Membrane</a></li>
  </ul></li>
  <li><a href="../guide/index.html" class="page">A Guide To Capabilities</a>
  <ul>
    <li><a href="../guide/introduction.html" class="page">Introducing Capabilities</a></li>
    <li><a href="../guide/creation.html" class="page">Creating Capabilities</a></li>
    <li><a href="../guide/authorization.html" class="page">Authorizing Capabilities</a></li>
    <li><a href="../guide/management.html" class="page">Managing Capabilities</a></li>
    <li><a href="../guide/confinement.html" class="active page">Confining Capabilities</a></li>
  </ul></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../guide/confinement.html#confining-capabilities" class="header">Confining Capabilities</a>
  <ul>
    <li><a href="../guide/confinement.html#encapsulating-capabilities-with-brands" class="header">Encapsulating Capabilities with Brands</a></li>
    <li><a href="../guide/confinement.html#confining-operations-with-membranes" class="header">Confining Operations with Membranes</a></li>
  </ul></li>
</ul>
</nav>

<div class="md-nav__title--site md-version" title="Version">
<i class="md-icon">label_outline</i> 0.1.0*
</div>
</nav>

</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../guide/confinement.html#confining-capabilities" class="header">Confining Capabilities</a>
  <ul>
    <li><a href="../guide/confinement.html#encapsulating-capabilities-with-brands" class="header">Encapsulating Capabilities with Brands</a></li>
    <li><a href="../guide/confinement.html#confining-operations-with-membranes" class="header">Confining Operations with Membranes</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#confining-capabilities" name="confining-capabilities" class="anchor"><span class="anchor-link"></span></a>Confining Capabilities</h1>
<p>Managing capabilities in the context of an architecture can be complex. </p>
<p>Design patterns of capability patterns can be hard to manage. One way to package capabilities is to use <em>composition</em>, but it may also make sense to organize capabilities in a tree structure connected to resources.</p>
<blockquote>
  <p>[I]f your abstraction requires 15 distinct capabilities to get its job done, does its constructor take a flat list of 15 objects? What an unwieldy, annoying constructor! Instead, a better approach is to logically group these capabilities into separate objects, and maybe even use contextual storage like parents and children to make fetching them easier. &ndash; <a href="http://joeduffyblog.com/2015/11/10/objects-as-secure-capabilities/">Objects as Secure Capabilities, Joe Duffy</a></p>
</blockquote>
<p>One issue is that managing capabilities can mean limiting scope and access to an object reference, but many architectures assume a context in which all object references are publically accessible &ndash; for example, events may be sent across an event bus, or through a streaming model. And because data structures inherently involve object references, there&rsquo;s the question of how to keep capabilities safe and isolated.</p>
<p>We touched on this a little bit in the <code>Access</code> class which uses access modifiers and a companion object to construct capabilities which cannot be accessed directly. Unfortunately, in Scala, <a href="http://www.jesperdj.com/2016/01/08/scala-access-modifiers-and-qualifiers-in-detail/">access modifiers and qualifiers only apply to enclosing scope</a>, so there is no way to qualify private access to things outside that scope. However, there is a way to protect capabilities to produce this effect &ndash; through the use of <code>Brand</code>.</p>
<h2><a href="#encapsulating-capabilities-with-brands" name="encapsulating-capabilities-with-brands" class="anchor"><span class="anchor-link"></span></a>Encapsulating Capabilities with Brands</h2>
<p>A Brand is a means of &ldquo;<a href="https://people.mpi-sws.org/~dreyer/papers/ocpl/paper.pdf">providing data abstraction in the absence of static typing</a>.&rdquo; It consists of a sealing function, which provides a &ldquo;boxed&rdquo; reference to the capability <strong>which cannot be opened</strong>, and an unsealing function, which takes the box, and returns the contained capability. The best way of describing it is that a Brand provides both a canner and the associated can opener.</p>
<pre class="prettyprint"><code class="language-scala">import ocaps.Brand

object Main {
  case class Food(name: String)
  case class Can(food: Brand.Box[Food])
  class CanOpener(unsealer: Brand.Unsealer[Food]) {
    def open(can: Can): Food = {
      unsealer(can.food).get // throws exception if we did not seal this
    }
  }

  def main(args: Array[String]): Unit = {
    val (sealer, unsealer) = Brand.create[Food](&quot;canned food&quot;).tuple
    val canOfSpam: Can = Can(sealer(Food(&quot;spam&quot;)))

    val cannedFood: Brand.Box[Food] = canOfSpam.food
    println(s&quot;food = ${canOfSpam.food.toString}&quot;) // DOES NOT WORK
    val canOpener = new CanOpener(unsealer)

    // We need both Can and CanOpener to unseal.
    def openCan(can: Can, canOpener: CanOpener) = {
      val food: Food = canOpener.open(can)
      println(s&quot;food = $food&quot;) // WORKS
    }

    openCan(canOfSpam, canOpener)
  }
}
</code></pre>
<p>Because both an unsealer and the sealed item are necessary to unseal, the act of unsealing is inherently a case of <em>amplification</em>, where putting two capabilities together lets you do things that neither one could do individually.</p>
<p>Because dynamic sealing is</p>
<p>Signing</p>
<p>Encryption</p>
<p>Private Channel</p>
<p>Fuck yes, this is awesome.</p>
<p><a href="https://blog.acolyer.org/2016/10/19/protection-in-programming-languages/">https://blog.acolyer.org/2016/10/19/protection-in-programming-languages/</a></p>
<p>I think there is a use case I&rsquo;m not accounting for &ndash; in an Akka actor system hierarchy, you could have multiple actors that were all of the same type, but implement dynamic sealing to provide the same kind of &ldquo;dynamic private&rdquo; access privacy when passing messages &ndash; so the parent may have the unsealer but the children do not. Is this more in line with how sealers are used in practice?</p>
<p>Okay, so <a href="https://people.mpi-sws.org/~dreyer/papers/ocpl/paper.pdf">https://people.mpi-sws.org/~dreyer/papers/ocpl/paper.pdf</a> says </p>
<blockquote>
  <p>We now consider one of the oldest and most influential OCPs: dynamic sealing, also called the sealer-unsealer pattern. Originally proposed by Morris [1973], dynamic sealing makes it possible to support data abstraction in the absence of static typing. In this section, we show how OCPL supports compositional reasoning about dynamic sealing. In particular, we show how to implement dynamic sealing in HLA and how to give a compositional specification for this implementation, from which we derive useful specifications for interesting abstractions built on top of it and prove robust safety for representative clients. (We consider an alternative implementation of the OCP, satisfying a slightly weaker specification, in Appendix A. We also show how ideal specifications for cryptographic signing and encryption primitives can be derived from the specification of dynamic sealing in Appendix B.) </p>
  <p>The functionality of dynamic sealing. Morris [1973] introduced dynamic sealing to enforce data abstraction while interoperating with untrusted, potentially ill-typed code. He stipulated a function makeseal for generating pairs of functions (seal, unseal), such that (i) for every value v, seal v returns a value v â² serving as an opaque, low-integrity proxy for v; and (ii) for every value v â² , unseal v â² returns v, if v â² was produced by seal v, and otherwise gets stuck. The key point is that this seal-unseal pair supports data abstraction: the client of these functions can freely pass sealed values to untrusted code since they are low-integrity, while at the same time imposing whatever internal invariant it wants on the underlying values that they represent.</p>
</blockquote>
<p>Paper on sealers (which does not actually have that word in it, only the operations Seal and Unseal) <a href="http://www.erights.org/history/morris73.pdf">http://www.erights.org/history/morris73.pdf</a></p>
<p><a href="https://ai.google/research/pubs/pub45568">https://ai.google/research/pubs/pub45568</a></p>
<p><a href="http://www.cis.upenn.edu/~bcpierce/papers/infohide3.pdf">http://www.cis.upenn.edu/~bcpierce/papers/infohide3.pdf</a></p>
<p><a href="https://blog.acolyer.org/2016/10/19/protection-in-programming-languages/">https://blog.acolyer.org/2016/10/19/protection-in-programming-languages/</a></p>
<h2><a href="#confining-operations-with-membranes" name="confining-operations-with-membranes" class="anchor"><span class="anchor-link"></span></a>Confining Operations with Membranes</h2>
<p>A membrane is an extension of a <code>Revocable</code> that transitively imposes revocability on all references exchanged via the membrane.</p>
<ul>
  <li><a href="http://blog.ezyang.com/2013/03/what-is-a-membran/">What is a Membrane?</a></li>
  <li><a href="https://research.google.com/pubs/pub40736.html">Trustworthy Proxies: Virtualizing Objects with Invariants</a></li>
  <li><a href="https://web.archive.org/web/20160408162552/http://www.eros-os.org/pipermail/e-lang/2003-January/008434.html">https://web.archive.org/web/20160408162552/http://www.eros-os.org/pipermail/e-lang/2003-January/008434.html</a></li>
</ul>
<p>Membranes are supposed to stop messages passing from one place to another without being wrapped.</p>
<p>The generalized way to implement a membrane in Java and Scala is to use an <code>InvocationHandler</code> as a dynamic proxy.</p>
<ul>
  <li><a href="http://www.baeldung.com/java-dynamic-proxies">http://www.baeldung.com/java-dynamic-proxies</a></li>
  <li><a href="https://www.concretepage.com/java/dynamic-proxy-with-proxy-and-invocationhandler-in-java">https://www.concretepage.com/java/dynamic-proxy-with-proxy-and-invocationhandler-in-java</a></li>
</ul>
<p>There are two ways to implement membranes in a type safe way.</p>
<p>The first is to have a membrane class which will wrap everything, and have the membrane act as an effect. This does require classes to &ldquo;opt in&rdquo; to the membrane.</p>
<p>The second is to make all capabilities take an implicit membrane context.</p>
<ul>
  <li><a href="https://www.info.ucl.ac.be/~pvr/rr2005-03.pdf">Capability confinement by membranes</a></li>
</ul>
<p>TODO</p>
<p>// <a href="http://wiki.erights.org/wiki/Walnut/Secure_Distributed_Computing/Capability_Patterns#Membranes">http://wiki.erights.org/wiki/Walnut/Secure_Distributed_Computing/Capability_Patterns#Membranes</a> // <a href="http://blog.ezyang.com/2013/03/what-is-a-membran/">http://blog.ezyang.com/2013/03/what-is-a-membran/</a></p>
</div>
<div>
<a href="https://github.com/wsargent/ocaps/tree/master/site/src/main/paradox/guide/confinement.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1.0*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../guide/management.html" title="Managing Capabilities" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Managing Capabilities
</span>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../assets/javascripts/application.5165553b.js"></script>
<script src="../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../."}})</script>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
